<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.0</version>
    <date>2024-03-27T08:33:01Z</date>
    <groups>
        <group>
            <uuid>e0242822f07b4633a283b8dc935d3dd9</uuid>
            <name>Templates_Created</name>
        </group>
    </groups>
    <templates>
        <template>
            <uuid>df1ea6e9762141daa92c25725d37fb3b</uuid>
            <template>Template Cisco BGP SNMP</template>
            <name>Template Cisco BGP SNMP</name>
            <description>Template Cisco BGP Sessions 
-AdminStatus
-Established Time
-OperationStatus
-AS Name
-Maximum Prefix
-Accepted Prefix
-BGP last Error

By: Flavio Gomes Figueira Camacho Junior

Require:
ValueMaps
.BGP4-MIB::bgpPeerAdminStatus
.BGP4-MIB::bgpPeerState

ExternalScript
.as.name
.oid_to_ipv6

Base: 
CISCO-BGP4-MIB.mib
http://www.circitor.fr/Mibs/Html/C/CISCO-BGP4-MIB.php#cbgpPeer2RemoteAs

External Scripts and Value Mapping on my Github:
https://github.com/flaviojunior1995/Zabbix-Templates</description>
            <groups>
                <group>
                    <name>Templates_Created</name>
                </group>
            </groups>
            <discovery_rules>
                <discovery_rule>
                    <uuid>4fa01ae1605a41c4b8bd69edeac04e98</uuid>
                    <name>BGPv6 Peers Discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.9.9.187.1.2.5.1.6.2.16,{#SNMPASN},.1.3.6.1.4.1.9.9.187.1.2.5.1.11.2.16]</snmp_oid>
                    <key>cbgpPeer2LocalAddr[&quot;BGPv6&quot;]</key>
                    <delay>1h</delay>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>e4d5966c58974667a9ab58a35b2888cf</uuid>
                            <name>AS Name for IPv6 peer &quot;$2&quot; ASN &quot;$1&quot;</name>
                            <type>EXTERNAL</type>
                            <key>as_name[&quot;{#SNMPASN}&quot;,&quot;{#SNMPINDEX}&quot;,&quot;BGPv6&quot;]</key>
                            <delay>1d</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>40348053edc7447082fafb4bde7f33da</uuid>
                            <name>Administrative status for peer &quot;$1&quot; ASN &quot;$2&quot;</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.187.1.2.5.1.4.2.16.{#SNMPINDEX}</snmp_oid>
                            <key>cbgp6Peer2AdminStatus[&quot;{#SNMPINDEX}&quot;,&quot;{#SNMPASN}&quot;]</key>
                            <delay>10m</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <valuemap>
                                <name>BGP4-MIB::bgpPeerAdminStatus</name>
                            </valuemap>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>61c821c42bff4c83be0e25bda57ff42c</uuid>
                            <name>Established time for peer &quot;$1&quot; ASN &quot;$2&quot;</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.187.1.2.5.1.19.2.16.{#SNMPINDEX}</snmp_oid>
                            <key>cbgp6Peer2FsmEstablishedTime[&quot;{#SNMPINDEX}&quot;,&quot;{#SNMPASN}&quot;]</key>
                            <delay>10m</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <units>uptime</units>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>07b241687ca64f2db1639068c84b1aa8</uuid>
                            <name>Remote AS for peer &quot;$1&quot; ASN &quot;$2&quot;</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.187.1.2.5.1.11.2.16.{#SNMPINDEX}</snmp_oid>
                            <key>cbgp6Peer2RemoteAs[&quot;{#SNMPINDEX}&quot;,&quot;{#SNMPASN}&quot;]</key>
                            <delay>1d</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6cebb9ca919648528fe5dcc510be75ad</uuid>
                            <name>Operational status for peer &quot;$1&quot; ASN &quot;$2&quot;</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.187.1.2.5.1.3.2.16.{#SNMPINDEX}</snmp_oid>
                            <key>cbgp6Peer2State[&quot;{#SNMPINDEX}&quot;,&quot;{#SNMPASN}&quot;]</key>
                            <history>30d</history>
                            <trends>0</trends>
                            <valuemap>
                                <name>BGP4-MIB::bgpPeerState</name>
                            </valuemap>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>dbb93036b3cc439699e3f1c05e510ef2</uuid>
                            <name>BGP peer last error &quot;$1&quot; ASN &quot;$2&quot;</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.187.1.2.5.1.17.2.16.{#SNMPINDEX}</snmp_oid>
                            <key>cbgpPeer2LastError[&quot;{#SNMPINDEX}&quot;,&quot;{#SNMPASN}&quot;]</key>
                            <delay>10m</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>value = (value.replace(/\s+/g, ''));

if (value === &quot;0000&quot;) {
   return &quot;NO last error&quot;
}

if (value === &quot;0100&quot;) {
   return &quot;Message Header Error - Unspecific&quot;
}

if (value === &quot;0101&quot;) {
   return &quot;Message Header Error - Connection Not Synchronized&quot;
}

if (value === &quot;0102&quot;) {
   return &quot;Message Header Error - Bad Message Length&quot;
}

if (value === &quot;0103&quot;) {
   return &quot;Message Header Error - Bad Message Type&quot;
}

if (value === &quot;0200&quot;) {
   return &quot;OPEN Message Error - Unspecific&quot;
}

if (value === &quot;0201&quot;) {
   return &quot;OPEN Message Error - Unsupported Version Number&quot;
}

if (value === &quot;0202&quot;) {
   return &quot;OPEN Message Error - Bad Peer AS&quot;
}

if (value === &quot;0203&quot;) {
   return &quot;OPEN Message Error - Bad BGP Identifier&quot;
}

if (value === &quot;0204&quot;) {
   return &quot;OPEN Message Error - Unsupported Optional Parameter&quot;
}

if (value === &quot;0205&quot;) {
   return &quot;OPEN Message Error - [Deprecated]&quot;
}

if (value === &quot;0206&quot;) {
   return &quot;OPEN Message Error - Unacceptable Hold Time&quot;
}

if (value === &quot;0207&quot;) {
   return &quot;OPEN Message Error - Unsupported Capability&quot;;
}

if (value === &quot;0208&quot;) {
   return &quot;OPEN Message Error - Role Mismatch (Expire on 2021-03-29)&quot;
}

if (value === &quot;0300&quot;) {
   return &quot;UPDATE Message Error - Unspecific&quot;
}

if (value === &quot;0301&quot;) {
   return &quot;UPDATE Message Error - Malformed Attribute List&quot;
}

if (value === &quot;0302&quot;) {
   return &quot;UPDATE Message Error - Unrecognized Well-known Attibute&quot;
}

if (value === &quot;0303&quot;) {
   return &quot;UPDATE Message Error - Missing Well-know Attribute&quot;
}

if (value === &quot;0304&quot;) {
   return &quot;UPDATE Message Error - Attribute Flags Error&quot;
}

if (value === &quot;0305&quot;) {
   return &quot;UPDATE Message Error - Attribute Length Error&quot;
}

if (value === &quot;0306&quot;) {
   return &quot;UPDATE Message Error - Invalid ORIGIN Attribute&quot;
}

if (value === &quot;0307&quot;) {
   return &quot;UPDATE Message Error - [Deprecated]&quot;
}

if (value === &quot;0308&quot;) {
   return &quot;UPDATE Message Error - Invalid NEXT_HOP Attribute&quot;
}

if (value === &quot;0309&quot;) {
   return &quot;UPDATE Message Error - Optional Attribute Error&quot;
}

if (value === &quot;0310&quot;) {
   return &quot;UPDATE Message Error - Invalid Network Field&quot;
}

if (value === &quot;0311&quot;) {
   return &quot;UPDATE Message Error - Malformed AS_PATH&quot;
}

if (value === &quot;0400&quot;) {
   return &quot;Hold Timer Expired&quot;
}

if (value === &quot;0500&quot;) {
   return &quot;Finite State Machine Error - Unspecified Error&quot;
}

if (value === &quot;0501&quot;) {
   return &quot;Finite State Machine Error - Receive Unexpected Message in OpenSent State&quot;
}

if (value === &quot;0502&quot;) {
   return &quot;Finite State Machine Error - Receive Unexpected Message in OpenConfirm State&quot;
}

if (value === &quot;0503&quot;) {
   return &quot;Finite State Machine Error - Receive Unexpected Message in Established State&quot;
}

if (value === &quot;0600&quot;) {
   return &quot;Cease NOTIFICATION - Reserved&quot;
}

if (value === &quot;0601&quot;) {
   return &quot;Cease NOTIFICATION - Maximum Number of Prefixes Reached&quot;
}

if (value === &quot;0602&quot;) {
   return &quot;Cease NOTIFICATION - Administrative Shutdown&quot;
}

if (value === &quot;0603&quot;) {
   return &quot;Cease NOTIFICATION - Peer De-configured&quot;
}

if (value === &quot;0604&quot;) {
   return &quot;Cease NOTIFICATION - Administrative Reset&quot;
}

if (value === &quot;0605&quot;) {
   return &quot;Cease NOTIFICATION - Connection Rejected&quot;
}

if (value === &quot;0606&quot;) {
   return &quot;Cease NOTIFICATION - Other Configuration Change&quot;
}

if (value === &quot;0607&quot;) {
   return &quot;Cease NOTIFICATION - Connection Collision Resolution&quot;
}

if (value === &quot;0608&quot;) {
   return &quot;Cease NOTIFICATION - Out of Resources&quot;
}

if (value === &quot;0609&quot;) {
   return &quot;Cease NOTIFICATION - Hard Reset&quot;
}

if (value === &quot;0700&quot;) {
   return &quot;ROUTE-REFRESH Message Error - Reserded&quot;
}

if (value === &quot;0701&quot;) {
   return &quot;ROUTE-REFRESH Message Error - Invalid Message Length&quot;
}

return value</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>487b3c957b684e48870935e429e109f4</uuid>
                            <name>Remote IPv6 Peer &quot;$1&quot;</name>
                            <type>EXTERNAL</type>
                            <key>oid_to_ipv6[&quot;{#SNMPINDEX}&quot;]</key>
                            <delay>1d</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv6 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <uuid>58ea7436e4b0422aa5b6e5c3d4cf98ce</uuid>
                            <expression>last(/Template Cisco BGP SNMP/cbgp6Peer2FsmEstablishedTime[&quot;{#SNMPINDEX}&quot;,&quot;{#SNMPASN}&quot;])&lt;{$PEER_LOW_TIME} and last(/Template Cisco BGP SNMP/oid_to_ipv6[&quot;{#SNMPINDEX}&quot;])&lt;&gt;0</expression>
                            <name>BGPv6 peer up time low {ITEM.LASTVALUE2} ASN {#SNMPASN}</name>
                            <priority>INFO</priority>
                            <dependencies>
                                <dependency>
                                    <name>BGPv6 peer {ITEM.LASTVALUE3} ASN {#SNMPASN} is DOWN</name>
                                    <expression>last(/Template Cisco BGP SNMP/cbgp6Peer2State[&quot;{#SNMPINDEX}&quot;,&quot;{#SNMPASN}&quot;],#3)&lt;&gt;6 and last(/Template Cisco BGP SNMP/cbgp6Peer2AdminStatus[&quot;{#SNMPINDEX}&quot;,&quot;{#SNMPASN}&quot;])=2 and last(/Template Cisco BGP SNMP/oid_to_ipv6[&quot;{#SNMPINDEX}&quot;])&lt;&gt;0</expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>829f1a07e53a4d84b784091228bb17b7</uuid>
                            <expression>last(/Template Cisco BGP SNMP/cbgp6Peer2State[&quot;{#SNMPINDEX}&quot;,&quot;{#SNMPASN}&quot;],#3)&lt;&gt;6 and last(/Template Cisco BGP SNMP/cbgp6Peer2AdminStatus[&quot;{#SNMPINDEX}&quot;,&quot;{#SNMPASN}&quot;])=2 and last(/Template Cisco BGP SNMP/oid_to_ipv6[&quot;{#SNMPINDEX}&quot;])&lt;&gt;0</expression>
                            <name>BGPv6 peer {ITEM.LASTVALUE3} ASN {#SNMPASN} is DOWN</name>
                            <priority>HIGH</priority>
                        </trigger_prototype>
                    </trigger_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <uuid>608ad0f21bb44e9686b883b01cdb20ea</uuid>
                    <name>BGPv4 Peers Discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPASN},.1.3.6.1.4.1.9.9.187.1.2.5.1.11.1.4]</snmp_oid>
                    <key>cbgpPeer2RemoteAs[&quot;BGPv4&quot;]</key>
                    <delay>1h</delay>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>9f8c9d46f10840c0acd71e3b8bfe0ef7</uuid>
                            <name>AS Name for IPv4 peer &quot;{#SNMPINDEX}&quot;</name>
                            <type>EXTERNAL</type>
                            <key>as_name[&quot;{#SNMPASN}&quot;,&quot;{#SNMPINDEX}&quot;]</key>
                            <delay>1d</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>ff5314dc48a44513a5ce2e066b9b91b2</uuid>
                            <name>Administrative status for peer &quot;$1&quot;</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.187.1.2.5.1.4.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>cbgpPeer2AdminStatus[{#SNMPINDEX}]</key>
                            <delay>10m</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <valuemap>
                                <name>BGP4-MIB::bgpPeerAdminStatus</name>
                            </valuemap>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>673f05576f1a439a8e6329321be5c7a2</uuid>
                            <name>Established time for peer &quot;$1&quot;</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.187.1.2.5.1.19.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>cbgpPeer2FsmEstablishedTime[{#SNMPINDEX}]</key>
                            <delay>10m</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <units>uptime</units>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>440660f892d241b4a4eacb9469080651</uuid>
                                    <expression>last(/Template Cisco BGP SNMP/cbgpPeer2FsmEstablishedTime[{#SNMPINDEX}])&lt;{$PEER_LOW_TIME}</expression>
                                    <name>BGPv4 peer up time low {#SNMPINDEX} ASN {#SNMPASN}</name>
                                    <priority>INFO</priority>
                                    <dependencies>
                                        <dependency>
                                            <name>BGPv4 peer {#SNMPINDEX} ASN {#SNMPASN} is DOWN</name>
                                            <expression>last(/Template Cisco BGP SNMP/cbgpPeer2State[{#SNMPINDEX}],#3)&lt;&gt;6 and last(/Template Cisco BGP SNMP/cbgpPeer2AdminStatus[{#SNMPINDEX}])=2</expression>
                                        </dependency>
                                    </dependencies>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>ce5d9b861a314c098db1105b26c4f0da</uuid>
                            <name>Remote AS for peer &quot;$1&quot;</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.187.1.2.5.1.11.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>cbgpPeer2RemoteAs[{#SNMPINDEX}]</key>
                            <delay>1d</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c9d5aa0b5bc941e68981ecc619f53a56</uuid>
                            <name>Operational status for peer &quot;$1&quot;</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.187.1.2.5.1.3.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>cbgpPeer2State[{#SNMPINDEX}]</key>
                            <history>30d</history>
                            <trends>0</trends>
                            <valuemap>
                                <name>BGP4-MIB::bgpPeerState</name>
                            </valuemap>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>96443a4f067f4565910ad0f895802731</uuid>
                            <name>BGP peer last error &quot;$1&quot;</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.187.1.2.1.1.7.{#SNMPINDEX}</snmp_oid>
                            <key>cbgpPeerLastErrorTxt[&quot;{#SNMPINDEX}&quot;]</key>
                            <delay>10m</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c2a0438de1254d1983ee78e7d6340657</uuid>
                            <name>Accepted prefix for peer &quot;$1&quot;</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.187.1.2.1.1.1.{#SNMPINDEX}</snmp_oid>
                            <key>cbgpPeerPrefixAccepted[{#SNMPINDEX}]</key>
                            <delay>10m</delay>
                            <history>7d</history>
                            <trends>180d</trends>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>389b51615437461ebd0bd8ed6e55525b</uuid>
                            <name>Maximum prefix for peer &quot;$1&quot;</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.187.1.2.1.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>cbgpPeerPrefixLimit[{#SNMPINDEX}]</key>
                            <delay>1h</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4</value>
                                </tag>
                                <tag>
                                    <tag>Application</tag>
                                    <value>BGPv4 {#SNMPINDEX}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <uuid>4958dfdff6ea4032b8f06372989b05cd</uuid>
                            <expression>last(/Template Cisco BGP SNMP/cbgpPeer2State[{#SNMPINDEX}],#3)&lt;&gt;6 and last(/Template Cisco BGP SNMP/cbgpPeer2AdminStatus[{#SNMPINDEX}])=2</expression>
                            <name>BGPv4 peer {#SNMPINDEX} ASN {#SNMPASN} is DOWN</name>
                            <priority>HIGH</priority>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>43fc058e3e674e11ba6df272f5fffd44</uuid>
                            <expression>( last(/Template Cisco BGP SNMP/cbgpPeerPrefixAccepted[{#SNMPINDEX}]) * 100 / last(/Template Cisco BGP SNMP/cbgpPeerPrefixLimit[{#SNMPINDEX}]) ) &gt; {$MAXIMUM_PREFIX_ALARM}</expression>
                            <name>BGPv4 Prefix Limit {#SNMPINDEX} ASN {#SNMPASN} near</name>
                            <priority>WARNING</priority>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>1eaede01349b4d439dbd5109398e6042</uuid>
                            <name>BGP Prefix Accepted {#SNMPINDEX}</name>
                            <ymin_type_1>FIXED</ymin_type_1>
                            <graph_items>
                                <graph_item>
                                    <drawtype>BOLD_LINE</drawtype>
                                    <color>FF0000</color>
                                    <item>
                                        <host>Template Cisco BGP SNMP</host>
                                        <key>cbgpPeerPrefixLimit[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>00FF00</color>
                                    <item>
                                        <host>Template Cisco BGP SNMP</host>
                                        <key>cbgpPeerPrefixAccepted[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$MAXIMUM_PREFIX_ALARM}</macro>
                    <value>80</value>
                    <description>% maximum prefix limit alarm to reach 100%</description>
                </macro>
                <macro>
                    <macro>{$PEER_LOW_TIME}</macro>
                    <value>14400</value>
                    <description>time in sec alarm for uptime bgp session</description>
                </macro>
            </macros>
            <dashboards>
                <dashboard>
                    <uuid>fb59bbe5c2b24762bffb7c22e9dbe479</uuid>
                    <name>Screen BGPv4</name>
                    <pages>
                        <page>
                            <widgets>
                                <widget>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <width>24</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>2</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>rows</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH_PROTOTYPE</type>
                                            <name>graphid</name>
                                            <value>
                                                <name>BGP Prefix Accepted {#SNMPINDEX}</name>
                                                <host>Template Cisco BGP SNMP</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                    </pages>
                </dashboard>
            </dashboards>
            <valuemaps>
                <valuemap>
                    <uuid>4dcc1842742743a9a387a351b13709af</uuid>
                    <name>BGP4-MIB::bgpPeerAdminStatus</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>stoped</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>started</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>6b5a8a055457492fa26c21ffc2a8b180</uuid>
                    <name>BGP4-MIB::bgpPeerState</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>idle</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>connect</newvalue>
                        </mapping>
                        <mapping>
                            <value>3</value>
                            <newvalue>active</newvalue>
                        </mapping>
                        <mapping>
                            <value>4</value>
                            <newvalue>opensent</newvalue>
                        </mapping>
                        <mapping>
                            <value>5</value>
                            <newvalue>openconfirm</newvalue>
                        </mapping>
                        <mapping>
                            <value>6</value>
                            <newvalue>established</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
            </valuemaps>
        </template>
    </templates>
</zabbix_export>
